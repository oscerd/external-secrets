apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    controller-gen.kubebuilder.io/version: v0.16.2
  name: azurekvs.providers.external-secrets.io
spec:
  group: providers.external-secrets.io
  names:
    categories:
    - azure
    kind: AzureKv
    listKind: AzureKvList
    plural: azurekvs
    shortNames:
    - azure
    singular: azurekv
  scope: Cluster
  versions:
  - name: v1alpha1
    schema:
      openAPIV3Schema:
        properties:
          apiVersion:
            description: |-
              APIVersion defines the versioned schema of this representation of an object.
              Servers should convert recognized schemas to the latest internal value, and
              may reject unrecognized values.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources
            type: string
          kind:
            description: |-
              Kind is a string value representing the REST resource this object represents.
              Servers may infer this from the endpoint the client submits requests to.
              Cannot be updated.
              In CamelCase.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds
            type: string
          metadata:
            type: object
          spec:
            description: Configures an store to sync secrets using AzureKvKV.
            properties:
              authSecretRef:
                description: Auth configures how the operator authenticates with Azure.
                  Required for ServicePrincipal auth type. Optional for WorkloadIdentity.
                properties:
                  clientCertificate:
                    description: The AzureKvClientCertificate of the service principle
                      used for authentication.
                    properties:
                      key:
                        description: |-
                          The key of the entry in the Secret resource's `data` field to be used. Some instances of this field may be
                          defaulted, in others it may be required.
                        type: string
                      name:
                        description: The name of the Secret resource being referred
                          to.
                        type: string
                      namespace:
                        description: |-
                          Namespace of the resource being referred to. Ignored if referent is not cluster-scoped. cluster-scoped defaults
                          to the namespace of the referent.
                        type: string
                    type: object
                  clientId:
                    description: The AzureKvclientId of the service principle or managed
                      identity used for authentication.
                    properties:
                      key:
                        description: |-
                          The key of the entry in the Secret resource's `data` field to be used. Some instances of this field may be
                          defaulted, in others it may be required.
                        type: string
                      name:
                        description: The name of the Secret resource being referred
                          to.
                        type: string
                      namespace:
                        description: |-
                          Namespace of the resource being referred to. Ignored if referent is not cluster-scoped. cluster-scoped defaults
                          to the namespace of the referent.
                        type: string
                    type: object
                  clientSecret:
                    description: The AzureKvClientSecret of the service principle
                      used for authentication.
                    properties:
                      key:
                        description: |-
                          The key of the entry in the Secret resource's `data` field to be used. Some instances of this field may be
                          defaulted, in others it may be required.
                        type: string
                      name:
                        description: The name of the Secret resource being referred
                          to.
                        type: string
                      namespace:
                        description: |-
                          Namespace of the resource being referred to. Ignored if referent is not cluster-scoped. cluster-scoped defaults
                          to the namespace of the referent.
                        type: string
                    type: object
                  tenantId:
                    description: The AzureKvtenantId of the managed identity used
                      for authentication.
                    properties:
                      key:
                        description: |-
                          The key of the entry in the Secret resource's `data` field to be used. Some instances of this field may be
                          defaulted, in others it may be required.
                        type: string
                      name:
                        description: The name of the Secret resource being referred
                          to.
                        type: string
                      namespace:
                        description: |-
                          Namespace of the resource being referred to. Ignored if referent is not cluster-scoped. cluster-scoped defaults
                          to the namespace of the referent.
                        type: string
                    type: object
                type: object
              authType:
                default: ServicePrincipal
                description: |-
                  Auth type defines how to authenticate to the keyvault service.
                  Valid values are:
                  - "ServicePrincipal" (default): Using a service principal (tenantId, clientId, clientSecret)
                  - "ManagedIdentity": Using Managed Identity assigned to the pod (see aad-pod-identity)
                enum:
                - ServicePrincipal
                - ManagedIdentity
                - WorkloadIdentity
                type: string
              controller:
                description: |-
                  Used to select the correct ESO controller (think: ingress.ingressClassName)
                  The ESO controller is instantiated with a specific controller name and filters ES based on this property
                type: string
              environmentType:
                default: PublicCloud
                description: |-
                  EnvironmentType specifies the AzureKvcloud environment endpoints to use for
                  connecting and authenticating with Azure. By default it points to the public cloud AAD endpoint.
                  The following endpoints are available, also see here: https://github.com/Azure/go-autorest/blob/main/autorest/azure/environments.go#L152
                  PublicCloud, USGovernmentCloud, ChinaCloud, GermanCloud
                enum:
                - PublicCloud
                - USGovernmentCloud
                - ChinaCloud
                - GermanCloud
                type: string
              identityId:
                description: If multiple Managed Identity is assigned to the pod,
                  you can select the one to be used
                type: string
              refreshInterval:
                description: Used to configure store refresh interval in seconds.
                  Empty or 0 will default to the controller config.
                type: integer
              retrySettings:
                description: Used to configure http retries if failed
                properties:
                  maxRetries:
                    format: int32
                    type: integer
                  retryInterval:
                    type: string
                type: object
              serviceAccountRef:
                description: |-
                  ServiceAccountRef specified the service account
                  that should be used when authenticating with WorkloadIdentity.
                properties:
                  audiences:
                    description: |-
                      Audience specifies the `aud` claim for the service account token
                      If the service account uses a well-known annotation for e.g. IRSA or GCP Workload Identity
                      then this audiences will be appended to the list
                    items:
                      type: string
                    type: array
                  name:
                    description: The name of the ServiceAccount resource being referred
                      to.
                    type: string
                  namespace:
                    description: |-
                      Namespace of the resource being referred to. Ignored if referent is not cluster-scoped. cluster-scoped defaults
                      to the namespace of the referent.
                    type: string
                required:
                - name
                type: object
              tenantId:
                description: TenantID configures the AzureKvTenant to send requests
                  to. Required for ServicePrincipal auth type. Optional for WorkloadIdentity.
                type: string
              vaultUrl:
                description: Vault Url from which the secrets to be fetched from.
                type: string
            required:
            - vaultUrl
            type: object
        type: object
    served: true
    storage: true
    subresources:
      status: {}
